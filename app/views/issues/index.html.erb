<div class="container">
  <div class="row">
    <div class="col-md-3">
      <ul class="nav nav-pills nav-stacked">
        <li class="active"><a href="#all-issues" data-toggle="tab">All <span class="badge pull-right"><%= issues.size %></span></a></li>
        <li><a href="#qa-issues" data-toggle="tab">QA <span class="badge pull-right"><%= qa_issues.size %></span></a></li>
        <li><a href="#peer-review-issues" data-toggle="tab">Peer Review <span class="badge pull-right"><%= peer_review_issues.size %></span></a></li>
        <% users.each do |user| %>
          <li><a href="#<%= user.login %>-issues" data-toggle="tab"><%= user.login %> <span class="badge pull-right"><%= issues.count { |issue| issue.user.login == user.login } %></span></a></li>
        <% end %>
      </ul>
    </div>

    <div class="col-md-9">
      <div class="tab-content">
        <div class="tab-pane active" id="all-issues">
          <ul>
            <% issues.each do |issue| %>
              <li>
              <p><%= issue.rels[:html].href.gsub('https://github.com/', '').gsub(/\/issues\/\d+/, '') %></p>
              <p><%= link_to issue.title, issue.pull_request.rels[:html].href %> by <%= issue.user.login %></p>
              <a href="<%= issue.pull_request.rels[:html].href %>" class="btn btn-default">View on GitHub</a>
              <% if jira_id = issue.title.scan(/\[(.*)\]/).first.try(:first) %>
                <a href="https://edhdev.atlassian.net/browse/<%= jira_id %>" class="btn btn-default">View on JIRA</a>
              <% end %>
              </li>
            <% end %>
          </ul>
        </div>

        <div class="tab-pane" id="qa-issues">
          <ul>
            <% qa_issues.each do |issue| %>
              <li>
              <p><%= issue.rels[:html].href.gsub('https://github.com/', '').gsub(/\/issues\/\d+/, '') %></p>
              <p><%= link_to issue.title, issue.pull_request.rels[:html].href %> by <%= issue.user.login %></p>
              <a href="<%= issue.pull_request.rels[:html].href %>" class="btn btn-default">View on GitHub</a>
              <% if jira_id = issue.title.scan(/\[(.*)\]/).first.try(:first) %>
                <a href="https://edhdev.atlassian.net/browse/<%= jira_id %>" class="btn btn-default">View on JIRA</a>
              <% end %>
              </li>
            <% end %>
          </ul>
        </div>

        <div class="tab-pane" id="peer-review-issues">
          <ul>
            <% peer_review_issues.each do |issue| %>
              <li>
              <p><%= issue.rels[:html].href.gsub('https://github.com/', '').gsub(/\/issues\/\d+/, '') %></p>
              <p><%= link_to issue.title, issue.pull_request.rels[:html].href %> by <%= issue.user.login %></p>
              <a href="<%= issue.pull_request.rels[:html].href %>" class="btn btn-default">View on GitHub</a>
              <% if jira_id = issue.title.scan(/\[(.*)\]/).first.try(:first) %>
                <a href="https://edhdev.atlassian.net/browse/<%= jira_id %>" class="btn btn-default">View on JIRA</a>
              <% end %>
              </li>
            <% end %>
          </ul>
        </div>

        <% users.each do |user| %>
          <div class="tab-pane" id="<%= user.login %>-issues">
            <ul>
              <% issues.select { |issue| issue.user.login == user.login }.each do |issue| %>
                <li>
                <p><%= issue.rels[:html].href.gsub('https://github.com/', '').gsub(/\/issues\/\d+/, '') %></p>
                <p><%= link_to issue.title, issue.pull_request.rels[:html].href %> by <%= issue.user.login %></p>
                <a href="<%= issue.pull_request.rels[:html].href %>" class="btn btn-default">View on GitHub</a>
                <% if jira_id = issue.title.scan(/\[(.*)\]/).first.try(:first) %>
                  <a href="https://edhdev.atlassian.net/browse/<%= jira_id %>" class="btn btn-default">View on JIRA</a>
                <% end %>
              </li>
              <% end %>
            </ul>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
